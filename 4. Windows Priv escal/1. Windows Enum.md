### 사용자, 네트워크
```cmd
# local User 조회
net user
net user <user_name>
# 현재 사용자의 모든 정보 조회
whoami /all
# 현재 사용자가 속한 그룹 조회
whoami /groups
# 현재 사용자의 권한 조회
whoami /priv
# 로컬 그룹 조회
net localgroup
net localgroup <group_name>
# 도메인 그룹 조회
net groups
# 네트워크 인터페이스 조회
ipconfig /all
# 라우팅 테이블 조회
route print
# 활성 TCP/UDP 연결 표시
netstat -ano
```

### 기본
```powershell
# 숨김 파일 조회
dir /ad
# tree 형으로 탐색
tree /f /a
# 현재 경로 txt 조회
dir /s/b *.txt
# 로컬 User 조회 (cmd)
net user
net user <user_name>
# 로컬 User 조회
Get-LocalUser
# 로컬 Group 조회
Get-LocalGroup
# 그룹 멤버 조회
Get-LocalGroupMember <group_name>
# 환경 변수 조회 (cmd)
set
# 환경 변수 조회 (Powershell)
Get-ChildItem Env:
# OS 조회
systeminfo

```

### 레지스트리
```bash
# String matching in registry
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
# Putty
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions" /t REG_SZ /s
# VNC
reg query "HKCU\Software\ORL\WinVNC3\Password"
# Windows autologin
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"
```

### Powershell 히스토리 조회
```bash
# 히스토리 조회
Get-History
(Get-PSReadlineOption).HistorySavePath
# 환경변수 조회 (cmd)
set
# 환경변수 조회 (powershell)
Get-ChildItem Env:
```

### 프로세스 및 파일
```powershell
# 설치된 app 확인
Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname
Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname
# 실행 중인 app 확인
Get-Process
# C:\ 아래 *.kdbx 파일 검색
Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue
# C:\xampp 아래 *.txt, *.ini 검색
Get-ChildItem -Path C:\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue
# C:\Users 아래 *.db, *.log, *.txt, *.pdf, *.xls, *.xlsx, *.doc, *.docx 검색
Get-ChildItem -Path C:\Users\ -Include *.db, *.log, *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue
# C:\ 아래 *.db, *.log 검색
Get-ChildItem -Path C:\ -Include *.db, *.log -File -Recurse -ErrorAction SilentlyContinue

```

### Cron 작업 조회
```powershell
# 예약 작업 전체 확인
schtasks /query /fo LIST /v
# 예약 실행 바이너리 권한 확인
icacls C:\Users\steve\Pictures\BackendCacheCleanup.exe
# TaskName, TaskPath, State만 간략하게 찾아보기 (Powershell)
Get-ScheduledTask | ft TaskName,TaskPath,State
# 이름과 Microsoft 예약 작업 전부 거르기 (powershell)
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```

### SharpUp 스캐닝
```sh
.\SharpUp.exe audit
```